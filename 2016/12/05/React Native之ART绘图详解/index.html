<!DOCTYPE HTML>
<html>
<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no">
    <link rel="dns-prefetch" href="//t11.baidu.com">
    <!--SEO-->



<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">
    <!--Title-->


<title>react-native之ART绘图详解 | 向志洪</title>


    <link rel="alternate" href="/atom.xml" title="向志洪" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css?rev=9.12.0">


<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css?rev=3.3.4">
<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">
    <div class="hide">
    <script src="https://s4.cnzz.com/z_stat.php?id=1261768793&web_id=1262140174" language="JavaScript"></script>
    </div>
    
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?13764659765";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
	
	<script src="https://cdn1.lncld.net/static/js/av-min-1.2.1.js"></script>
    <script>AV.initialize("aj42pgqDHRSVhMknqDb3JMeg-gzGzoHsz", "qbRaoHOP9NMWPOow8PandkH3");</script>
</head></html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->
<body>
    <header class="main-header">
    <div class="main-header-box">
        <a class="branding" href="/" title="">
            <img src="/img/header_logo.png" alt="Snippet 博客主题">
        </a>
        <h2 class="text-hide">Snippet主题</h2>
        <img src="/img/header_logo.png" alt="Snippet 博客主题" class="hide">
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only">Toggle navigation</span>
                    <i class="fa fa-bars"></i>
                    </span>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class=""><a href="/">首页</a></li>
                        
                            <li role="presentation" class=""><a href="/categories/前端/">前端</a></li>
                        
                            <li role="presentation" class=""><a href="/categories/后端/">后端</a></li>
                        
                            <li role="presentation" class=""><a href="/categories/Java/">Java</a></li>
                        
                            <li role="presentation" class=""><a href="/categories/Python/">Python</a></li>
                        
                            <li role="presentation" class=""><a href="/categories/Android/">Android</a></li>
                        
                            <li role="presentation" class=""><a href="/categories/iOS/">iOS</a></li>
                        
                            <li role="presentation" class=""><a href="/categories/React Native/">React Native</a></li>
                        
                            <li role="presentation" class=""><a href="/categories/小程序/">小程序</a></li>
                        
                            <li role="presentation" class=""><a href="/categories/杂谈/">杂谈</a></li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="react-native之ART绘图详解">
            
            react-native之ART绘图详解
            
        </h1>
        <div class="post-meta">
    
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <span>React Native</span>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
            React Native
            
        </span>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta">2016/12/05</span>
    </span>
</div>
            
            
            <p class="fa fa-exclamation-triangle warning">
                本文于<strong>433</strong>天之前发表，文中内容可能已经过时。
            </p>
            
    </div>
    
    <div class="post-body">
        <h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>在移动应用的开发过程中，绘制基本的二维图形或动画是必不可少的。然而，考虑到Android和iOS均有一套各自的API方案，因此采用一种更普遍接受的技术方案，更有利于代码的双平台兼容。</p>
<p>art是一个旨在多浏览器兼容的Node style CommonJS模块。在它的基础上，Facebook又开发了react-art ，封装art，使之可以被react.js所使用，即实现了前端的svg库。然而，考虑到react.js的JSX语法，已经支持将<cirle> <svg>等等svg标签直接插入到dom中（当然此时使用的就不是react-art库了）此外还有HTML canvas的存在，因此，在前端上，react-art并非不可替代。</svg></cirle></p>
<p>然而，在移动端，考虑到跨平台的需求，加之web端的技术积累，react-art成为了现成的绘制图形的解决方案。react-native分别在0.10.0和0.18.0上添加了iOS和Android平台上对react-art的支持。</p>
<h2 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h2><p>React.js和React-Native的区别，只在于下文所述的ART获取上，然后该例子就可以同时应用在Web端和移动端上了。react-art自带的官方例子：<a href="https://github.com/reactjs/react-art/tree/master/examples/vector-widget" target="_blank" rel="external">Vector-Widget</a></p>
<p>Vector-Widget额外实现了旋转，以及鼠标点击事件的旋转加速响应。Web端可以看到点击加速，但是在移动端无效，原因是React Native并未对Group中onMouseDown和onMouseUp属性作处理。本文着重于静态svg的实现，暂时无视动画部分效果即可。</p>
<h2 id="ART"><a href="#ART" class="headerlink" title="ART"></a>ART</h2><p>在React Native中ART是个非常重要的库，它让非常酷炫的绘图及动画变成了可能。需要注意的是，在React Native引入ART过程中，Android默认就包含ART库，IOS需要单独添加依赖库。</p>
<h3 id="ios添加依赖库"><a href="#ios添加依赖库" class="headerlink" title="ios添加依赖库"></a>ios添加依赖库</h3><p>1、使用xcode中打开React-native中的iOS项目，选中‘Libraries’目录 ——&gt; 右键选择‘Add Files to 项目名称’ ——&gt; ‘node_modules/react-native/Libraries/ART/ART.xcodeproj’ 添加；<br><img src="http://img.blog.csdn.net/20170802101113668?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhbmd6aGlob25nOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>2、选中项目根目录 ——&gt; 点击’Build Phases‘ ——&gt; 点击‘Link Binary With Libraries’ ——&gt; 点击左下方‘+’ ——&gt; 选中‘libART.a’添加。</p>
<p><img src="http://img.blog.csdn.net/20170802101149129?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhbmd6aGlob25nOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="基础组件"><a href="#基础组件" class="headerlink" title="基础组件"></a>基础组件</h2><p>ART暴露的组件共有7个，本文介绍常用的四个组件：Surface、Group、Shape、Text。</p>
<ul>
<li>Surface - 一个矩形可渲染的区域，是其他元素的容器</li>
<li>Group - 可容纳多个形状、文本和其他的分组</li>
<li>Shape - 形状定义，可填充</li>
<li>Text - 文本形状定义</li>
</ul>
<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><p><strong>Surface</strong></p>
<ul>
<li>width : 渲染区域的宽</li>
<li>height : 定义渲染区域的高</li>
</ul>
<p><strong>Shape</strong></p>
<ul>
<li>d : 定义绘制路径</li>
<li>stroke : 描边颜色</li>
<li>strokeWidth : 描边宽度</li>
<li>strokeDash : 定义虚线</li>
<li>fill : 填充颜色</li>
</ul>
<p><strong>Text</strong></p>
<ul>
<li>funt : 字体样式，定义字体、大小、是否加粗 如: bold 35px Heiti SC</li>
</ul>
<p><strong>Path</strong></p>
<ul>
<li>moveTo(x,y) : 移动到坐标（x,y）</li>
<li>lineTo(x,y) : 连线到（x,y）</li>
<li>arc() : 绘制弧线</li>
<li>close() : 封闭空间</li>
</ul>
<h1 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h1><h2 id="绘制直线"><a href="#绘制直线" class="headerlink" title="绘制直线"></a>绘制直线</h2><p><img src="http://img.blog.csdn.net/20170802102521283?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhbmd6aGlob25nOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">import React from &apos;react&apos;</div><div class="line">import &#123;</div><div class="line">    View,</div><div class="line">    ART</div><div class="line">&#125; from &apos;react-native&apos;</div><div class="line"></div><div class="line">export default class Line extends React.Component&#123;</div><div class="line"></div><div class="line">    render()&#123;</div><div class="line"></div><div class="line">        const path = ART.Path();</div><div class="line">        path.moveTo(1,1); //将起始点移动到(1,1) 默认(0,0)</div><div class="line">        path.lineTo(300,1); //连线到目标点(300,1)</div><div class="line"></div><div class="line">        return(</div><div class="line">            &lt;View style=&#123;this.props.style&#125;&gt;</div><div class="line">                &lt;ART.Surface width=&#123;300&#125; height=&#123;2&#125;&gt;</div><div class="line">                    &lt;ART.Shape d=&#123;path&#125; stroke=&quot;#000000&quot; strokeWidth=&#123;1&#125; /&gt;</div><div class="line">                &lt;/ART.Surface&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="绘制虚线"><a href="#绘制虚线" class="headerlink" title="绘制虚线"></a>绘制虚线</h2><p>了解strokeDash的参数，<br>[10,5] : 表示绘10像素实线在绘5像素空白，如此循环<br>[10,5,20,5] : 表示绘10像素实线在绘制5像素空白在绘20像素实线及5像素空白</p>
<p><img src="http://img.blog.csdn.net/20170802102916147?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhbmd6aGlob25nOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">import React from &apos;react&apos;</div><div class="line">import &#123;</div><div class="line">    View,</div><div class="line">    ART</div><div class="line">&#125; from &apos;react-native&apos;</div><div class="line"></div><div class="line">const &#123;Surface, Shape, Path&#125; = ART;</div><div class="line"></div><div class="line">export default class DashLine extends React.Component&#123;</div><div class="line"></div><div class="line">    render()&#123;</div><div class="line"></div><div class="line">        const path = Path()</div><div class="line">            .moveTo(1,1)</div><div class="line">            .lineTo(300,1);</div><div class="line"></div><div class="line">        return(</div><div class="line">            &lt;View style=&#123;this.props.style&#125;&gt;</div><div class="line">                &lt;Surface width=&#123;300&#125; height=&#123;2&#125;&gt;</div><div class="line">                    &lt;Shape d=&#123;path&#125; stroke=&quot;#000000&quot; strokeWidth=&#123;2&#125; strokeDash=&#123;[10,5]&#125;/&gt;</div><div class="line">                &lt;/Surface&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="绘制矩形"><a href="#绘制矩形" class="headerlink" title="绘制矩形"></a>绘制矩形</h2><p>首先通过lineTo绘制三条边，在使用close链接第四条边。fill做颜色填充.<br><img src="http://img.blog.csdn.net/20170802104018278?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhbmd6aGlob25nOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">import React from &apos;react&apos;</div><div class="line">import &#123;</div><div class="line">    View,</div><div class="line">    ART</div><div class="line">&#125; from &apos;react-native&apos;</div><div class="line"></div><div class="line">const &#123;Surface, Shape, Path&#125; = ART;</div><div class="line"></div><div class="line">export default class Rect extends React.Component&#123;</div><div class="line"></div><div class="line">    render()&#123;</div><div class="line"></div><div class="line">        const path = new Path()</div><div class="line">            .moveTo(1,1)</div><div class="line">            .lineTo(1,99)</div><div class="line">            .lineTo(99,99)</div><div class="line">            .lineTo(99,1)</div><div class="line">            .close();</div><div class="line"></div><div class="line">        return(</div><div class="line">            &lt;View style=&#123;this.props.style&#125;&gt;</div><div class="line">                &lt;Surface width=&#123;100&#125; height=&#123;100&#125;&gt;</div><div class="line">                    &lt;Shape d=&#123;path&#125; stroke=&quot;#000000&quot; fill=&quot;#892265&quot; strokeWidth=&#123;1&#125; /&gt;</div><div class="line">                &lt;/Surface&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="绘圆"><a href="#绘圆" class="headerlink" title="绘圆"></a>绘圆</h2><p>了解arc(x,y,radius)的使用, 终点坐标距离起点坐标的相对距离。</p>
<p><img src="http://img.blog.csdn.net/20170802104512315?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhbmd6aGlob25nOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">import React from &apos;react&apos;</div><div class="line">import &#123;</div><div class="line">    View,</div><div class="line">    ART</div><div class="line">&#125; from &apos;react-native&apos;</div><div class="line"></div><div class="line">const &#123;Surface, Shape, Path&#125; = ART;</div><div class="line"></div><div class="line">export default class Circle extends React.Component&#123;</div><div class="line"></div><div class="line">    render()&#123;</div><div class="line"></div><div class="line">        const path = new Path()</div><div class="line">            .moveTo(50,1)</div><div class="line">            .arc(0,99,25)</div><div class="line">            .arc(0,-99,25)</div><div class="line">            .close();</div><div class="line"></div><div class="line"></div><div class="line">        return(</div><div class="line">            &lt;View style=&#123;this.props.style&#125;&gt;</div><div class="line">                &lt;Surface width=&#123;100&#125; height=&#123;100&#125;&gt;</div><div class="line">                    &lt;Shape d=&#123;path&#125; stroke=&quot;#000000&quot; strokeWidth=&#123;1&#125;/&gt;</div><div class="line">                &lt;/Surface&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="绘制文字"><a href="#绘制文字" class="headerlink" title="绘制文字"></a>绘制文字</h2><p>了解funt属性的使用，规则是“粗细 字号 字体”<br>注意： 字体应该是支持path属性的，应该是实现bug并没有不生效。 Android通过修改源码是可以解决的，IOS没看源码。</p>
<p><img src="http://img.blog.csdn.net/20170802105554470?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhbmd6aGlob25nOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">import React, &#123;Component&#125; from &apos;react&apos;;</div><div class="line">import &#123;</div><div class="line">    AppRegistry,</div><div class="line">    StyleSheet,</div><div class="line">    ART,</div><div class="line">    View</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line"></div><div class="line">const &#123;Surface, Text, Path&#125; = ART;</div><div class="line"></div><div class="line">export default class ArtTextView extends Component &#123;</div><div class="line"></div><div class="line">    render() &#123;</div><div class="line"></div><div class="line">        return (</div><div class="line">            &lt;View style=&#123;styles.container&#125;&gt;</div><div class="line">                &lt;Surface width=&#123;100&#125; height=&#123;100&#125;&gt;</div><div class="line">                    &lt;Text strokeWidth=&#123;1&#125; stroke=&quot;#000&quot; font=&quot;bold 35px Heiti SC&quot; path=&#123;new Path().moveTo(40,40).lineTo(99,10)&#125; &gt;React&lt;/Text&gt;</div><div class="line">                &lt;/Surface&gt;</div><div class="line"></div><div class="line">            &lt;/View&gt;</div><div class="line"></div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">    container: &#123;</div><div class="line">        flex: 1,</div><div class="line">        justifyContent: &apos;center&apos;,</div><div class="line">        alignItems: &apos;center&apos;,</div><div class="line">        backgroundColor: &apos;#F5FCFF&apos;,</div><div class="line">    &#125;,</div><div class="line"></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="绘制扇形"><a href="#绘制扇形" class="headerlink" title="绘制扇形"></a>绘制扇形</h2><p><img src="http://img.blog.csdn.net/20170802110035113?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveGlhbmd6aGlob25nOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>在这里需要使用arc做路径绘制。<br>Wedge.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div></pre></td><td class="code"><pre><div class="line">import React, &#123; Component, PropTypes &#125; from &apos;react&apos;;</div><div class="line">import &#123; ART &#125; from &apos;react-native&apos;;</div><div class="line">const &#123; Shape, Path &#125; = ART;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Wedge is a React component for drawing circles, wedges and arcs.	Like other</div><div class="line"> * ReactART components, it must be used in a &lt;Surface&gt;.</div><div class="line"> */</div><div class="line">export default class Wedge extends Component&lt;void, any, any&gt; &#123;</div><div class="line"></div><div class="line">    static propTypes = &#123;</div><div class="line">        outerRadius: PropTypes.number.isRequired,</div><div class="line">        startAngle: PropTypes.number.isRequired,</div><div class="line">        endAngle: PropTypes.number.isRequired,</div><div class="line">        originX: PropTypes.number.isRequired,</div><div class="line">        originY: PropTypes.number.isRequired,</div><div class="line">        innerRadius: PropTypes.number,</div><div class="line">    &#125;;</div><div class="line"></div><div class="line"></div><div class="line">    constructor(props : any) &#123;</div><div class="line">        super(props);</div><div class="line">        (this:any).circleRadians = Math.PI * 2;</div><div class="line">        (this:any).radiansPerDegree = Math.PI / 180;</div><div class="line">        (this:any)._degreesToRadians = this._degreesToRadians.bind(this);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * _degreesToRadians(degrees)</div><div class="line">     *</div><div class="line">     * Helper function to convert degrees to radians</div><div class="line">     *</div><div class="line">     * @param &#123;number&#125; degrees</div><div class="line">     * @return &#123;number&#125;</div><div class="line">     */</div><div class="line">    _degreesToRadians(degrees : number) : number &#123;</div><div class="line">        if (degrees !== 0 &amp;&amp; degrees % 360 === 0) &#123; // 360, 720, etc.</div><div class="line">            return (this:any).circleRadians;</div><div class="line">        &#125;</div><div class="line">        return degrees * (this:any).radiansPerDegree % (this:any).circleRadians;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * _createCirclePath(or, ir)</div><div class="line">     *</div><div class="line">     * Creates the ReactART Path for a complete circle.</div><div class="line">     *</div><div class="line">     * @param &#123;number&#125; or The outer radius of the circle</div><div class="line">     * @param &#123;number&#125; ir The inner radius, greater than zero for a ring</div><div class="line">     * @return &#123;object&#125;</div><div class="line">     */</div><div class="line">    _createCirclePath(or : number, ir : number) : Path &#123;</div><div class="line">        const path = new Path();</div><div class="line"></div><div class="line">        path.move(0, or)</div><div class="line">            .arc(or * 2, 0, or)</div><div class="line">            .arc(-or * 2, 0, or);</div><div class="line"></div><div class="line">        if (ir) &#123;</div><div class="line">            path.move(or - ir, 0)</div><div class="line">                .counterArc(ir * 2, 0, ir)</div><div class="line">                .counterArc(-ir * 2, 0, ir);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        path.close();</div><div class="line"></div><div class="line">        return path;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * _createArcPath(sa, ea, ca, or, ir)</div><div class="line">     *</div><div class="line">     * Creates the ReactART Path for an arc or wedge.</div><div class="line">     *</div><div class="line">     * @param &#123;number&#125; startAngle The starting degrees relative to 12 o&apos;clock</div><div class="line">     * @param &#123;number&#125; endAngle The ending degrees relative to 12 o&apos;clock</div><div class="line">     * @param &#123;number&#125; or The outer radius in pixels</div><div class="line">     * @param &#123;number&#125; ir The inner radius in pixels, greater than zero for an arc</div><div class="line">     * @return &#123;object&#125;</div><div class="line">     */</div><div class="line">    _createArcPath(originX : number, originY : number, startAngle : number, endAngle : number, or : number, ir : number) : Path &#123;</div><div class="line">        const path = new Path();</div><div class="line"></div><div class="line">        // angles in radians</div><div class="line">        const sa = this._degreesToRadians(startAngle);</div><div class="line">        const ea = this._degreesToRadians(endAngle);</div><div class="line"></div><div class="line">        // central arc angle in radians</div><div class="line">        const ca = sa &gt; ea ? (this:any).circleRadians - sa + ea : ea - sa;</div><div class="line"></div><div class="line">        // cached sine and cosine values</div><div class="line">        const ss = Math.sin(sa);</div><div class="line">        const es = Math.sin(ea);</div><div class="line">        const sc = Math.cos(sa);</div><div class="line">        const ec = Math.cos(ea);</div><div class="line"></div><div class="line">        // cached differences</div><div class="line">        const ds = es - ss;</div><div class="line">        const dc = ec - sc;</div><div class="line">        const dr = ir - or;</div><div class="line"></div><div class="line">        // if the angle is over pi radians (180 degrees)</div><div class="line">        // we will need to let the drawing method know.</div><div class="line">        const large = ca &gt; Math.PI;</div><div class="line"></div><div class="line">        // TODO (sema) Please improve theses comments to make the math</div><div class="line">        // more understandable.</div><div class="line">        //</div><div class="line">        // Formula for a point on a circle at a specific angle with a center</div><div class="line">        // at (0, 0):</div><div class="line">        // x = radius * Math.sin(radians)</div><div class="line">        // y = radius * Math.cos(radians)</div><div class="line">        //</div><div class="line">        // For our starting point, we offset the formula using the outer</div><div class="line">        // radius because our origin is at (top, left).</div><div class="line">        // In typical web layout fashion, we are drawing in quadrant IV</div><div class="line">        // (a.k.a. Southeast) where x is positive and y is negative.</div><div class="line">        //</div><div class="line">        // The arguments for path.arc and path.counterArc used below are:</div><div class="line">        // (endX, endY, radiusX, radiusY, largeAngle)</div><div class="line"></div><div class="line">        path.move(or + or * ss, or - or * sc) // move to starting point</div><div class="line">            .arc(or * ds, or * -dc, or, or, large) // outer arc</div><div class="line">            .line(dr * es, dr * -ec);	// width of arc or wedge</div><div class="line"></div><div class="line">        if (ir) &#123;</div><div class="line">            path.counterArc(ir * -ds, ir * dc, ir, ir, large); // inner arc</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        return path;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    render() : any &#123;</div><div class="line">        // angles are provided in degrees</div><div class="line">        const startAngle = this.props.startAngle;</div><div class="line">        const endAngle = this.props.endAngle;</div><div class="line">        // if (startAngle - endAngle === 0) &#123;</div><div class="line">        // 	return null;</div><div class="line">        // &#125;</div><div class="line"></div><div class="line">        // radii are provided in pixels</div><div class="line">        const innerRadius = this.props.innerRadius || 0;</div><div class="line">        const outerRadius = this.props.outerRadius;</div><div class="line"></div><div class="line">        const &#123; originX, originY &#125; = this.props;</div><div class="line"></div><div class="line">        // sorted radii</div><div class="line">        const ir = Math.min(innerRadius, outerRadius);</div><div class="line">        const or = Math.max(innerRadius, outerRadius);</div><div class="line"></div><div class="line">        let path;</div><div class="line">        if (endAngle &gt;= startAngle + 360) &#123;</div><div class="line">            path = this._createCirclePath(or, ir);</div><div class="line">        &#125; else &#123;</div><div class="line">            path = this._createArcPath(originX, originY, startAngle, endAngle, or, ir);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        return &lt;Shape &#123;...this.props&#125; d=&#123;path&#125; /&gt;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>示例代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">import React from &apos;react&apos;</div><div class="line">import &#123;</div><div class="line">    View,</div><div class="line">    ART</div><div class="line">&#125; from  &apos;react-native&apos;</div><div class="line"></div><div class="line">const &#123;Surface&#125; = ART;</div><div class="line">import Wedge from &apos;./Wedge&apos;</div><div class="line"></div><div class="line">export default class Fan extends  React.Component&#123;</div><div class="line"></div><div class="line">    render()&#123;</div><div class="line"></div><div class="line">        return(</div><div class="line">            &lt;View style=&#123;this.props.style&#125;&gt;</div><div class="line">                &lt;Surface width=&#123;100&#125; height=&#123;100&#125;&gt;</div><div class="line">                    &lt;Wedge</div><div class="line">                     outerRadius=&#123;50&#125;</div><div class="line">                     startAngle=&#123;0&#125;</div><div class="line">                     endAngle=&#123;60&#125;</div><div class="line">                     originX=&#123;50&#125;</div><div class="line">                     originY=&#123;50&#125;</div><div class="line">                     fill=&quot;blue&quot;/&gt;</div><div class="line"></div><div class="line">                &lt;/Surface&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="综合示例"><a href="#综合示例" class="headerlink" title="综合示例"></a>综合示例</h2><p><img src="http://img.blog.csdn.net/20161125140809415" alt="这里写图片描述"></p>
<p>相关代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * Sample React Native App</div><div class="line"> * https://github.com/facebook/react-native</div><div class="line"> * @flow</div><div class="line"> */</div><div class="line"></div><div class="line">import React, &#123;</div><div class="line">    Component</div><div class="line">&#125;from &apos;react&apos;;</div><div class="line">import &#123;</div><div class="line">    ART as Art,</div><div class="line">    StyleSheet,</div><div class="line">    View,</div><div class="line">    Dimensions,</div><div class="line">    TouchableWithoutFeedback,</div><div class="line">    Animated</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line"></div><div class="line">var HEART_SVG = &quot;M130.4-0.8c25.4 0 46 20.6 46 46.1 0 13.1-5.5 24.9-14.2 33.3L88 153.6 12.5 77.3c-7.9-8.3-12.8-19.6-12.8-31.9 0-25.5 20.6-46.1 46-46.2 19.1 0 35.5 11.7 42.4 28.4C94.9 11 111.3-0.8 130.4-0.8&quot;</div><div class="line">var HEART_COLOR = &apos;rgb(226,38,77,1)&apos;;</div><div class="line">var GRAY_HEART_COLOR = &quot;rgb(204,204,204,1)&quot;;</div><div class="line"></div><div class="line">var FILL_COLORS = [</div><div class="line">    &apos;rgba(221,70,136,1)&apos;,</div><div class="line">    &apos;rgba(212,106,191,1)&apos;,</div><div class="line">    &apos;rgba(204,142,245,1)&apos;,</div><div class="line">    &apos;rgba(204,142,245,1)&apos;,</div><div class="line">    &apos;rgba(204,142,245,1)&apos;,</div><div class="line">    &apos;rgba(0,0,0,0)&apos;</div><div class="line">];</div><div class="line"></div><div class="line">var PARTICLE_COLORS = [</div><div class="line">    &apos;rgb(158, 202, 250)&apos;,</div><div class="line">    &apos;rgb(161, 235, 206)&apos;,</div><div class="line">    &apos;rgb(208, 148, 246)&apos;,</div><div class="line">    &apos;rgb(244, 141, 166)&apos;,</div><div class="line">    &apos;rgb(234, 171, 104)&apos;,</div><div class="line">    &apos;rgb(170, 163, 186)&apos;</div><div class="line">]</div><div class="line"></div><div class="line">getXYParticle = (total, i, radius) =&gt; &#123;</div><div class="line">    var angle = ( (2 * Math.PI) / total ) * i;</div><div class="line"></div><div class="line">    var x = Math.round((radius * 2) * Math.cos(angle - (Math.PI / 2)));</div><div class="line">    var y = Math.round((radius * 2) * Math.sin(angle - (Math.PI / 2)));</div><div class="line">    return &#123;</div><div class="line">        x: x,</div><div class="line">        y: y,</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">getRandomInt = (min, max) =&gt; &#123;</div><div class="line">    return Math.floor(Math.random() * (max - min)) + min;</div><div class="line">&#125;</div><div class="line"></div><div class="line">shuffleArray = (array) =&gt; &#123;</div><div class="line">    for (var i = array.length - 1; i &gt; 0; i--) &#123;</div><div class="line">        var j = Math.floor(Math.random() * (i + 1));</div><div class="line">        var temp = array[i];</div><div class="line">        array[i] = array[j];</div><div class="line">        array[j] = temp;</div><div class="line">    &#125;</div><div class="line">    return array;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">var &#123;</div><div class="line">    Surface,</div><div class="line">    Group,</div><div class="line">    Shape,</div><div class="line">    Path</div><div class="line">&#125; = Art;</div><div class="line"></div><div class="line">//使用Animated.createAnimatedComponent对其他组件创建对话</div><div class="line">//创建一个灰色的新型图片</div><div class="line">var AnimatedShape = Animated.createAnimatedComponent(Shape);</div><div class="line"></div><div class="line">var &#123;</div><div class="line">    width: deviceWidth,</div><div class="line">    height: deviceHeight</div><div class="line">&#125; = Dimensions.get(&apos;window&apos;);</div><div class="line"></div><div class="line">export default  class ArtAnimView extends Component &#123;</div><div class="line">    constructor(props) &#123;</div><div class="line">        super(props);</div><div class="line"></div><div class="line">        this.state = &#123;</div><div class="line">            animation: new Animated.Value(0)</div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    explode = () =&gt; &#123;</div><div class="line">        Animated.timing(this.state.animation, &#123;</div><div class="line">            duration: 1500,</div><div class="line">            toValue: 28</div><div class="line">        &#125;).start(() =&gt; &#123;</div><div class="line">            this.state.animation.setValue(0);</div><div class="line">            this.forceUpdate();</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    getSmallExplosions = (radius, offset) =&gt; &#123;</div><div class="line">        return [0, 1, 2, 3, 4, 5, 6].map((v, i, t) =&gt; &#123;</div><div class="line"></div><div class="line">            var scaleOut = this.state.animation.interpolate(&#123;</div><div class="line">                inputRange: [0, 5.99, 6, 13.99, 14, 21],</div><div class="line">                outputRange: [0, 0, 1, 1, 1, 0],</div><div class="line">                extrapolate: &apos;clamp&apos;</div><div class="line">            &#125;);</div><div class="line"></div><div class="line">            var moveUp = this.state.animation.interpolate(&#123;</div><div class="line">                inputRange: [0, 5.99, 14],</div><div class="line">                outputRange: [0, 0, -15],</div><div class="line">                extrapolate: &apos;clamp&apos;</div><div class="line">            &#125;);</div><div class="line"></div><div class="line">            var moveDown = this.state.animation.interpolate(&#123;</div><div class="line">                inputRange: [0, 5.99, 14],</div><div class="line">                outputRange: [0, 0, 15],</div><div class="line">                extrapolate: &apos;clamp&apos;</div><div class="line">            &#125;);</div><div class="line"></div><div class="line">            var color_top_particle = this.state.animation.interpolate(&#123;</div><div class="line">                inputRange: [6, 8, 10, 12, 17, 21],</div><div class="line">                outputRange: shuffleArray(PARTICLE_COLORS)</div><div class="line">            &#125;)</div><div class="line"></div><div class="line">            var color_bottom_particle = this.state.animation.interpolate(&#123;</div><div class="line">                inputRange: [6, 8, 10, 12, 17, 21],</div><div class="line">                outputRange: shuffleArray(PARTICLE_COLORS)</div><div class="line">            &#125;)</div><div class="line"></div><div class="line">            var position = getXYParticle(7, i, radius)</div><div class="line"></div><div class="line">            return (</div><div class="line">                &lt;Group</div><div class="line">                    x=&#123;position.x + offset.x &#125;</div><div class="line">                    y=&#123;position.y + offset.y&#125;</div><div class="line">                    rotation=&#123;getRandomInt(0, 40) * i&#125;</div><div class="line">                &gt;</div><div class="line">                    &lt;AnimatedCircle</div><div class="line">                        x=&#123;moveUp&#125;</div><div class="line">                        y=&#123;moveUp&#125;</div><div class="line">                        radius=&#123;15&#125;</div><div class="line">                        scale=&#123;scaleOut&#125;</div><div class="line">                        fill=&#123;color_top_particle&#125;</div><div class="line">                    /&gt;</div><div class="line">                    &lt;AnimatedCircle</div><div class="line">                        x=&#123;moveDown&#125;</div><div class="line">                        y=&#123;moveDown&#125;</div><div class="line">                        radius=&#123;8&#125;</div><div class="line">                        scale=&#123;scaleOut&#125;</div><div class="line">                        fill=&#123;color_bottom_particle&#125;</div><div class="line">                    /&gt;</div><div class="line">                &lt;/Group&gt;</div><div class="line">            )</div><div class="line">        &#125;, this)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    render() &#123;</div><div class="line">        var heart_scale = this.state.animation.interpolate(&#123;</div><div class="line">            inputRange: [0, .01, 6, 10, 12, 18, 28],</div><div class="line">            outputRange: [1, 0, .1, 1, 1.2, 1, 1],</div><div class="line">            extrapolate: &apos;clamp&apos;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        var heart_fill = this.state.animation.interpolate(&#123;</div><div class="line">            inputRange: [0, 2],</div><div class="line">            outputRange: [GRAY_HEART_COLOR, HEART_COLOR],</div><div class="line">            extrapolate: &apos;clamp&apos;</div><div class="line">        &#125;)</div><div class="line"></div><div class="line">        var heart_x = heart_scale.interpolate(&#123;</div><div class="line">            inputRange: [0, 1],</div><div class="line">            outputRange: [90, 0],</div><div class="line">        &#125;)</div><div class="line"></div><div class="line">        var heart_y = heart_scale.interpolate(&#123;</div><div class="line">            inputRange: [0, 1],</div><div class="line">            outputRange: [75, 0],</div><div class="line">        &#125;)</div><div class="line"></div><div class="line">        var circle_scale = this.state.animation.interpolate(&#123;</div><div class="line">            inputRange: [0, 1, 4],</div><div class="line">            outputRange: [0, .3, 1],</div><div class="line">            extrapolate: &apos;clamp&apos;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        var circle_stroke_width = this.state.animation.interpolate(&#123;</div><div class="line">            inputRange: [0, 5.99, 6, 7, 10],</div><div class="line">            outputRange: [0, 0, 15, 8, 0],</div><div class="line">            extrapolate: &apos;clamp&apos;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        var circle_fill_colors = this.state.animation.interpolate(&#123;</div><div class="line">            inputRange: [1, 2, 3, 4, 4.99, 5],</div><div class="line">            outputRange: FILL_COLORS,</div><div class="line">            extrapolate: &apos;clamp&apos;</div><div class="line">        &#125;)</div><div class="line"></div><div class="line">        var circle_opacity = this.state.animation.interpolate(&#123;</div><div class="line">            inputRange: [1, 9.99, 10],</div><div class="line">            outputRange: [1, 1, 0],</div><div class="line">            extrapolate: &apos;clamp&apos;</div><div class="line">        &#125;)</div><div class="line"></div><div class="line"></div><div class="line">        return (</div><div class="line">            &lt;View style=&#123;styles.container&#125;&gt;</div><div class="line">                &lt;TouchableWithoutFeedback onPress=&#123;this.explode&#125; style=&#123;styles.container&#125;&gt;</div><div class="line">                    &lt;View style=&#123;&#123;transform: [&#123;scale: .8&#125;]&#125;&#125;&gt;</div><div class="line">                        &lt;Surface width=&#123;deviceWidth&#125; height=&#123;deviceHeight&#125;&gt;</div><div class="line">                            &lt;Group x=&#123;75&#125; y=&#123;200&#125;&gt;</div><div class="line">                                &lt;AnimatedShape</div><div class="line">                                    d=&#123;HEART_SVG&#125;</div><div class="line">                                    x=&#123;heart_x&#125;</div><div class="line">                                    y=&#123;heart_y&#125;</div><div class="line">                                    scale=&#123;heart_scale&#125;</div><div class="line">                                    fill=&#123;heart_fill&#125;</div><div class="line">                                /&gt;</div><div class="line">                                &lt;AnimatedCircle</div><div class="line">                                    x=&#123;89&#125;</div><div class="line">                                    y=&#123;75&#125;</div><div class="line">                                    radius=&#123;150&#125;</div><div class="line">                                    scale=&#123;circle_scale&#125;</div><div class="line">                                    strokeWidth=&#123;circle_stroke_width&#125;</div><div class="line">                                    stroke=&#123;FILL_COLORS[2]&#125;</div><div class="line">                                    fill=&#123;circle_fill_colors&#125;</div><div class="line">                                    opacity=&#123;circle_opacity&#125;</div><div class="line">                                /&gt;</div><div class="line"></div><div class="line">                                &#123;this.getSmallExplosions(75, &#123;x: 89, y: 75&#125;)&#125;</div><div class="line">                            &lt;/Group&gt;</div><div class="line">                        &lt;/Surface&gt;</div><div class="line">                    &lt;/View&gt;</div><div class="line">                &lt;/TouchableWithoutFeedback&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">class AnimatedCircle extends Component &#123;</div><div class="line">    render() &#123;</div><div class="line">        var radius = this.props.radius;</div><div class="line">        var path = Path().moveTo(0, -radius)</div><div class="line">            .arc(0, radius * 2, radius)</div><div class="line">            .arc(0, radius * -2, radius)</div><div class="line">            .close();</div><div class="line">        return React.createElement(AnimatedShape);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">var styles = StyleSheet.create(&#123;</div><div class="line">    container: &#123;</div><div class="line">        flex: 1,</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
    </div>

    <div class="post-footer">   
        <div>
            
                转载声明: 商业转载请联系作者获得授权,非商业转载请注明出处 © Snippet
            
        </div>
        <div>
            
                版权声明: <a href="https://creativecommons.org/licenses/by-nc-nd/3.0/" target="_blank">
知识共享署名-非商业性使用-禁止演绎 3.0 未本地化版本许可协议（CC BY-NC-ND 3.0）
</a>
            
        </div>  
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/2016/12/14/微信小程序基本组件概述/" class="pre-post btn btn-default"><i class="fa fa-angle-left fa-fw"></i>上一篇</a>
    
    
        <a href="/2016/12/05/Angular2入坑指南/" class="next-post btn btn-default">下一篇<i class="fa fa-angle-right fa-fw"></i></a>
    
</div>


    <div id="comments">
        <div id="uyan_frame"></div>
    <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2120654"></script>
    </div>
                </main>
                <aside class="col-md-4 sidebar">
        
        <div class="widget notification">
        <h3 class="title">网站公告</h3>
        <div>
            <p>主题Snippet v1.1.0版本即将上线，敬请期待~ <br>
主题下载：<a href="https://github.com/shenliyang/hexo-theme-snippet" title="fork me" target="_blank">Snippet主题</a> <br>
<hr>前端工程师一枚，专注于前端Node、React和移动端Android和Ios开发，欢迎骚扰。
<br>联系方式：qq群:278792776（移动群）、515980159（React群）、188716429（猎头hr群）
</p>
        </div>
    </div>
        
        <div class="widget">
        <h3 class="title">分类</h3>
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/"><i class="fa" aria-hidden="true">Android</i></a><span class="category-list-count">41</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/系统/"><i class="fa" aria-hidden="true">系统</i></a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Google/"><i class="fa" aria-hidden="true">Google</i></a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Google/VR/"><i class="fa" aria-hidden="true">VR</i></a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/"><i class="fa" aria-hidden="true">Java</i></a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kotlin/"><i class="fa" aria-hidden="true">Kotlin</i></a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PWA/"><i class="fa" aria-hidden="true">PWA</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/"><i class="fa" aria-hidden="true">Python</i></a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/React-Native/"><i class="fa" aria-hidden="true">React Native</i></a><span class="category-list-count">19</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/"><i class="fa" aria-hidden="true">Spring</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/android/"><i class="fa" aria-hidden="true">android</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/"><i class="fa" aria-hidden="true">iOS</i></a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ios/"><i class="fa" aria-hidden="true">ios</i></a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/"><i class="fa" aria-hidden="true">python</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/人工智能/"><i class="fa" aria-hidden="true">人工智能</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/"><i class="fa" aria-hidden="true">前端</i></a><span class="category-list-count">22</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/区块链/"><i class="fa" aria-hidden="true">区块链</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/后端/"><i class="fa" aria-hidden="true">后端</i></a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/小程序/"><i class="fa" aria-hidden="true">小程序</i></a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术人生/"><i class="fa" aria-hidden="true">技术人生</i></a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/"><i class="fa" aria-hidden="true">机器学习</i></a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/杂谈/"><i class="fa" aria-hidden="true">杂谈</i></a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程语言/"><i class="fa" aria-hidden="true">编程语言</i></a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/设计模式/"><i class="fa" aria-hidden="true">设计模式</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/资料库/"><i class="fa" aria-hidden="true">资料库</i></a><span class="category-list-count">1</span></li></ul>
    </div>
        
        <div class="widget">
      <h3 class="title">归档</h3>
        <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/"><i class="fa" aria-hidden="true">二月 2018</i></a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/"><i class="fa" aria-hidden="true">一月 2018</i></a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/"><i class="fa" aria-hidden="true">十二月 2017</i></a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/"><i class="fa" aria-hidden="true">十一月 2017</i></a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/"><i class="fa" aria-hidden="true">十月 2017</i></a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/"><i class="fa" aria-hidden="true">九月 2017</i></a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/"><i class="fa" aria-hidden="true">八月 2017</i></a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/"><i class="fa" aria-hidden="true">七月 2017</i></a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/"><i class="fa" aria-hidden="true">六月 2017</i></a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/"><i class="fa" aria-hidden="true">五月 2017</i></a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/"><i class="fa" aria-hidden="true">四月 2017</i></a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/"><i class="fa" aria-hidden="true">三月 2017</i></a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/"><i class="fa" aria-hidden="true">二月 2017</i></a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/"><i class="fa" aria-hidden="true">一月 2017</i></a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/"><i class="fa" aria-hidden="true">十二月 2016</i></a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/"><i class="fa" aria-hidden="true">十一月 2016</i></a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/"><i class="fa" aria-hidden="true">十月 2016</i></a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/"><i class="fa" aria-hidden="true">九月 2016</i></a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/"><i class="fa" aria-hidden="true">八月 2016</i></a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/"><i class="fa" aria-hidden="true">七月 2016</i></a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/"><i class="fa" aria-hidden="true">六月 2016</i></a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/"><i class="fa" aria-hidden="true">五月 2016</i></a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/"><i class="fa" aria-hidden="true">四月 2016</i></a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/"><i class="fa" aria-hidden="true">三月 2016</i></a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/"><i class="fa" aria-hidden="true">二月 2016</i></a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/"><i class="fa" aria-hidden="true">一月 2016</i></a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/"><i class="fa" aria-hidden="true">九月 2015</i></a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/"><i class="fa" aria-hidden="true">六月 2015</i></a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/"><i class="fa" aria-hidden="true">五月 2015</i></a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/"><i class="fa" aria-hidden="true">四月 2015</i></a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/"><i class="fa" aria-hidden="true">三月 2015</i></a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/"><i class="fa" aria-hidden="true">一月 2015</i></a><span class="archive-list-count">1</span></li></ul>
    </div>
        
        <div class="widget">
    <h3 class="title">标签云</h3>
    <div class="content tag-cloud">
      
        <a href="/tags/Spring/" style="font-size: 1em">Spring</a> <a href="/tags/前端/" style="font-size: 1em">前端</a> <a href="/tags/Python/" style="font-size: 1em">Python</a> <a href="/tags/新特性/" style="font-size: 1em">新特性</a> <a href="/tags/深入系统/" style="font-size: 1em">深入系统</a> <a href="/tags/系统服务/" style="font-size: 1em">系统服务</a> <a href="/tags/android/" style="font-size: 1em">android</a> <a href="/tags/混淆打包/" style="font-size: 1em">混淆打包</a> <a href="/tags/硬件/" style="font-size: 1em">硬件</a> <a href="/tags/Angular2/" style="font-size: 1em">Angular2</a> <a href="/tags/前端开发/" style="font-size: 1em">前端开发</a> <a href="/tags/iOS/" style="font-size: 1em">iOS</a> <a href="/tags/React-Native/" style="font-size: 1em">React Native</a> <a href="/tags/FlexBox布局/" style="font-size: 1em">FlexBox布局</a> <a href="/tags/Google/" style="font-size: 1em">Google</a> <a href="/tags/VR/" style="font-size: 1em">VR</a> <a href="/tags/小程序/" style="font-size: 1em">小程序</a> <a href="/tags/后端/" style="font-size: 1em">后端</a> <a href="/tags/Java/" style="font-size: 1em">Java</a> <a href="/tags/垃圾回收/" style="font-size: 1em">垃圾回收</a> <a href="/tags/Kotlin/" style="font-size: 1em">Kotlin</a> <a href="/tags/编程语言/" style="font-size: 1em">编程语言</a> <a href="/tags/Node/" style="font-size: 1em">Node</a> <a href="/tags/Promise/" style="font-size: 1em">Promise</a> <a href="/tags/OpenGL/" style="font-size: 1em">OpenGL</a> <a href="/tags/eact-Native/" style="font-size: 1em">eact Native</a> <a href="/tags/调试/" style="font-size: 1em">调试</a> <a href="/tags/打包/" style="font-size: 1em">打包</a> <a href="/tags/原生/" style="font-size: 1em">原生</a> <a href="/tags/Android/" style="font-size: 1em">Android</a> <a href="/tags/入门/" style="font-size: 1em">入门</a> <a href="/tags/ios/" style="font-size: 1em">ios</a> <a href="/tags/Swift/" style="font-size: 1em">Swift</a> <a href="/tags/swift/" style="font-size: 1em">swift</a> <a href="/tags/AR/" style="font-size: 1em">AR</a> <a href="/tags/Xcode/" style="font-size: 1em">Xcode</a> <a href="/tags/知识库/" style="font-size: 1em">知识库</a> <a href="/tags/webpack/" style="font-size: 1em">webpack</a> <a href="/tags/gulp/" style="font-size: 1em">gulp</a> <a href="/tags/https/" style="font-size: 1em">https</a> <a href="/tags/gif/" style="font-size: 1em">gif</a> <a href="/tags/mac/" style="font-size: 1em">mac</a> <a href="/tags/环境/" style="font-size: 1em">环境</a> <a href="/tags/原理/" style="font-size: 1em">原理</a> <a href="/tags/react/" style="font-size: 1em">react</a> <a href="/tags/杂谈/" style="font-size: 1em">杂谈</a> <a href="/tags/个人博客/" style="font-size: 1em">个人博客</a> <a href="/tags/流量/" style="font-size: 1em">流量</a> <a href="/tags/区块链/" style="font-size: 1em">区块链</a> <a href="/tags/全栈/" style="font-size: 1em">全栈</a> <a href="/tags/微信/" style="font-size: 1em">微信</a> <a href="/tags/搭建网站/" style="font-size: 1em">搭建网站</a> <a href="/tags/机器学习/" style="font-size: 1em">机器学习</a> <a href="/tags/算法/" style="font-size: 1em">算法</a> <a href="/tags/深入理解/" style="font-size: 1em">深入理解</a> <a href="/tags/内存分配/" style="font-size: 1em">内存分配</a> <a href="/tags/PWA/" style="font-size: 1em">PWA</a> <a href="/tags/人工智能/" style="font-size: 1em">人工智能</a> <a href="/tags/设计模式/" style="font-size: 1em">设计模式</a>
    </div>
  </div>
        
        <div class="widget">
        <h3 class="title">友链</h3>
        <div class="content friends-link">
        
            <a href="http://blog.csdn.net/xiangzhihong8/" class="fa" target="_blank">作者博客</a>
        
            <a href="https://yq.aliyun.com/u/xiangzhihong" class="fa" target="_blank">阿里云博客</a>
        
        </div>
    </div>
        
    </aside>
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<!--page counter part-->
<script>
function addCount (Counter) {
        url=$('.article-date').attr('href').trim();
        title = $('.article-title').text().trim();
        var query=new AV.Query(Counter);
        //use url as unique idnetfication
        query.equalTo("url",url);
        query.find({
            success: function(results){
                if(results.length>0)
                {
                    var counter=results[0];
                    counter.fetchWhenSave(true); //get recent result
                    counter.increment("time");
                    counter.save();
                }
                else
                {
                    var newcounter=new Counter();
                    newcounter.set("title",title);
                    newcounter.set("url",url);
                    newcounter.set("time",1);
                    newcounter.save(null,{
                        success: function(newcounter){
                        //alert('New object created');
                        },
                        error: function(newcounter,error){
                        alert('Failed to create');
                        }
                        });
                }
            },
            error: function(error){
                //find null is not a error
                alert('Error:'+error.code+" "+error.message);
            }
        });
}
$(function(){
        var Counter=AV.Object.extend("Counter");
        //only increse visit counting when intering a page
        if ($('.article-title').length == 1)
           addCount(Counter);
        var query=new AV.Query(Counter);
        query.descending("time");
        // the sum of popular posts
        query.limit(10); 
        query.find({
            success: function(results){
                    for(var i=0;i<results.length;i++)    
                    {
                        var counter=results[i];
                        title=counter.get("title");
                        url=counter.get("url");
                        time=counter.get("time");
                        // add to the popularlist widget
                        showcontent=title+" ("+time+")";
                        //notice the "" in href
                        $('.popularlist').append('<li><a href="'+url+'">'+showcontent+'</a></li>');
                    }
                },
            error: function(error){
                alert("Error:"+error.code+" "+error.message);
            }
            }
        )
        });
</script>
    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12"> 
                <span>Copyright &copy; 2017 
                </span> | 
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> | 
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>
<script src="/assets/highlight.pack.js?rev=@@hash"></script>
  <script>
    hljs.initHighlightingOnLoad(); //初始化代码高亮 
  </script>

<script src="/js/app.js?rev=@@hash"></script>
</body>
